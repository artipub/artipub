# ğŸ‰ ArtiPub
ç®€ä½“ä¸­æ–‡ | [English](./README.md)

![GitHub top language](https://img.shields.io/github/languages/top/Pup007/artipub)
![GitHub License](https://img.shields.io/github/license/Pup007/artipub)
![GitHub Actions Workflow Status](https://img.shields.io/github/actions/workflow/status/Pup007/artipub/release.yml)
![NPM Version](https://img.shields.io/npm/v/%40pup007%2Fartipub)

ArtiPubï¼ˆæ–‡ç« å‘å¸ƒåŠ©æ‰‹ï¼‰æ˜¯ä¸€ä¸ªæ—¨åœ¨ç®€åŒ–å†…å®¹åˆ›ä½œè€…è·¨å¹³å°å‘å¸ƒæ–‡ç« è¿‡ç¨‹çš„å·¥å…·åº“ã€‚å®ƒæä¾›äº†ä¸€å¥—ç®€å•çš„APIï¼Œå¯ä»¥è®©ä½ è½»æ¾åœ°å°†æ–‡ç« å‘å¸ƒåˆ°å¤šä¸ªå¹³å°ï¼Œå¦‚åšå®¢ã€ç¤¾äº¤åª’ä½“ç­‰ï¼Œæ— éœ€æ‰‹åŠ¨æ“ä½œæ¯ä¸ªå¹³å°ã€‚

## â“ ä¸ºä»€ä¹ˆéœ€è¦ArtiPub?
1. markdownä¸­å¼•ç”¨çš„æœ¬åœ°å›¾ç‰‡ï¼Œéœ€è¦æ‰‹åŠ¨å‹ç¼©å›¾ç‰‡ï¼Œç„¶åä¸Šä¼ è‡³å›¾åºŠï¼Œæœ€ååœ¨æŠŠå›¾ç‰‡é“¾æ¥æ›¿æ¢æ‰
2. markdownå†™å®Œæ–‡ç« åï¼Œæƒ³å‘å¸ƒè‡³å…¶ä»–å¹³å°é¿å…æ‰‹åŠ¨copy
3. markdownå†™å®Œæ–‡ç« åï¼Œæˆ‘éœ€è¦ä¿®æ”¹markdownä¸­çš„ä¸€äº›å†…å®¹ï¼Œè®©å…¶é‡æ–°ç”Ÿæˆmarkdownå†…å®¹
4. ...

> è¯´æ˜ï¼šArtiPubå…¨éƒ¨å¸®ä½ è‡ªåŠ¨è§£å†³è¿™äº›é—®é¢˜ï¼Œæœªæ¥å°†æ‹“å±•æ›´å¤šå†…å®¹

## âœ¨ ç‰¹ç‚¹

- ğŸŒ **å¤šå¹³å°å‘å¸ƒ**ï¼šæ”¯æŒå°†markdownæ–‡ç« å‘å¸ƒè‡³å¤šä¸ªä¸»æµå†…å®¹å¹³å°ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºNotionã€Mediumã€Dev.toç­‰ã€‚
- âœ¨ **ç®€å•æ˜“ç”¨**ï¼šæä¾›äº†ç®€æ´çš„APIï¼Œåªéœ€å‡ è¡Œä»£ç å³å¯å®ç°æ–‡ç« çš„å‘å¸ƒã€‚
- ğŸ”Œ **æ”¯æŒä¸­é—´ä»¶å’Œæ’ä»¶**ï¼šé€šè¿‡æ’ä»¶å’Œä¸­é—´ä»¶ï¼Œè®©ç”¨æˆ·æ›´ç»†ç²’åº¦çš„æ§åˆ¶å¤„ç†å’Œå‘å¸ƒæµç¨‹ã€‚
- ğŸ“– **å®Œå…¨å¼€æº**ï¼šé¼“åŠ±ç¤¾åŒºè´¡çŒ®ï¼ŒæŒç»­å¢åŠ æ–°çš„å¹³å°æ”¯æŒå’ŒåŠŸèƒ½ã€‚

## ğŸ“Œ TODO
- [x] DevToPublisherPlugin
- [ ] Document Site

## ğŸ”§ å†…ç½®

### å¤„ç†ä¸­é—´ä»¶
|åç§°|æ”¯æŒ|æè¿°|
|--|--|--|
|picCompress|âˆš|å›¾ç‰‡è‡ªåŠ¨å‹ç¼©|
|picUpload|âˆš|å›¾ç‰‡ä¸Šä¼ |

### å‘å¸ƒæ’ä»¶
|åç§°|æ”¯æŒ|æè¿°|
|--|--|--|
|NotionPublisherPlugin|âˆš|å‘å¸ƒè‡³notion|
|DevToPublisherPlugin|doing|å‘å¸ƒè‡³dev.to|


## ğŸ“¦ å®‰è£…

ä½¿ç”¨ npm å®‰è£… ï¼š

```bash
npm install -D @pup007/artipub
```

ä½¿ç”¨ yarn å®‰è£…ï¼š

```bash
yarn add -D @pup007/artipub
```

ä½¿ç”¨pnpm å®‰è£…ï¼š

```bash
pnpm add -D @pup007/artipub
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œå±•ç¤ºå¦‚ä½•ä½¿ç”¨ ArtiPub å‘å¸ƒä¸€ç¯‡æ–‡ç« åˆ°æŒ‡å®šå¹³å°ï¼š

### CommonJS 

```javascript
const { ArticleProcessor, PublisherManager, NotionPublisherPlugin } = require('@pup007/artipub');
```

### ES Module 

```javascript
import { ArticleProcessor, PublisherManager, NotionPublisherPlugin } from "@pup007/artipub"
```

### Example

```js
import { ArticleProcessor, PublisherManager, NotionPublisherPlugin } from "@pup007/artipub"
import path from "path";
import { fileURLToPath } from "url";

const { NOTION_API_KEY, NOTION_PAGE_ID } = process.env;
let {
 GITHUB_OWNER,
 GITHUB_REPO,
 GITHUB_DIR,
 GITHUB_BRANCH,
 GITHUB_TOKEN,
 GITHUB_COMMIT_AUTHOR,
 GITHUB_COMMIT_EMAIL,
} = process.env;

const __dirname = path.dirname(fileURLToPath(import.meta.url));

const articleProcessor = new ArticleProcessor({
 //tips: å¦‚æœä¸æƒ³ç”¨githubå›¾åºŠï¼Œ uploadImgOptionä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªå¼‚æ­¥å›¾ç‰‡ä¸Šä¼ å‡½æ•°ï¼Œæœ€åè¿”å›ä¸Šä¼ åçš„å›¾ç‰‡urlä¹Ÿå¯ä»¥
 uploadImgOption: {
  owner: GITHUB_OWNER,
  repo: GITHUB_REPO,
  dir: GITHUB_DIR,
  branch: GITHUB_BRANCH,
  token: GITHUB_TOKEN,
  commit_author: GITHUB_COMMIT_AUTHOR,
  commit_email: GITHUB_COMMIT_EMAIL
 }
});

articleProcessor.processMarkdown(path.resolve(__dirname, "../doc/xxx.md")).then(async ({ content }) => {
 let publisherManager = new PublisherManager(content);
 publisherManager.addPlugin(NotionPublisherPlugin({
  api_key: NOTION_API_KEY,
  page_id: NOTION_PAGE_ID
 }));
 let res = await publisherManager.publish();
 // output: [ { success: true, info: 'Published to Notion successfully!' } ]
});

```

## ğŸ’» å¼€å‘

> ç‰¹åˆ«æ³¨æ„ï¼šè¯·åŸºäºmasteråˆ›å»ºä¸€ä¸ªæ–°åˆ†æ”¯ï¼Œåœ¨æ–°åˆ†æ”¯ä¸Šå¼€å‘ï¼Œå¼€å‘å®Œååˆ›å»ºPRè‡³master

- å®‰è£…ä¾èµ–
  ```bash
  pnpm install
  ```

- æ–°å¢å¤„ç†ä¸­é—´ä»¶
  ```typescript
  export default async function customMiddleware(
    context: ProcessorContext,
    visit: TVisitor,
    next: Next) {
    //visitï¼šæ·±åº¦ä¼˜å…ˆéå†markdown astçš„æ¥å£ï¼Œæ–¹ä¾¿ç”¨æˆ·ä¿®æ”¹nodeï¼Œæ³¨æ„æ­¤è¿‡ç¨‹æ˜¯åŒæ­¥çš„ï¼Œå¦‚æœæƒ³è¦å¼‚æ­¥å¤„ç†ï¼Œå°±å…ˆæ‰¾åˆ°å¯¹åº”nodeï¼Œç„¶åå†æ·»åŠ å¼‚æ­¥å¤„ç†ï¼Œæœ€åè°ƒç”¨nextã€‚
    //next: å¤„ç†å®Œåè°ƒç”¨nextï¼Œå¦åˆ™ä¼šå¯¼è‡´ä¸€ç›´å¡ä½ä¸ä¼šå¾€ä¸‹æ‰§è¡Œ
  }
  ```
- æ–°å¢æ·»åŠ æ’ä»¶
  ```typescript
  export function XXXPublisherPlugin(option: any) {
    return async (
    articleTitle: string,
    visit: TVisitor,
    toMarkdown: ToMarkdown
  ): Promise<PublishResult> => {
      //visit: æ·±åº¦ä¼˜å…ˆéå†markdown astçš„æ¥å£ï¼Œæ–¹ä¾¿ç”¨æˆ·ä¿®æ”¹nodeï¼Œæ³¨æ„æ­¤è¿‡ç¨‹æ˜¯åŒæ­¥çš„
      //toMarkdown: ä¼šå°†ä¿®æ”¹åçš„ast é‡æ–°ç”Ÿæˆmarkdown, content å°±æ˜¯markdown å†…å®¹
      let { content } = toMarkdown();
      let res: PublishResult = {
        success: true,
        info: "Published to XXX",
      };
      //TODO:
      return res;
    };
  }
  ```

- æ‰“åŒ…
  ```bash
  pnpm build
  ```

- æµ‹è¯•: 
  1. å…ˆpnpm build æ‰“åŒ…artipub
  2. cd playground è¿›è¡ŒéªŒè¯æµ‹è¯•(æ³¨æ„ï¼šplaygroundä¸­çš„ä»»åŠ¡ä¸œè¥¿éƒ½ä¸è¦æäº¤ï¼Œä»…æœ¬åœ°æµ‹è¯•)

## ğŸ“„ è®¸å¯è¯

ArtiPub æ˜¯åœ¨ MIT è®¸å¯è¯ä¸‹å‘å¸ƒçš„ã€‚è¯¦æƒ…è¯·è§ [`LICENSE`](./LICENSE) æ–‡ä»¶ã€‚

## ğŸ™ è‡´è°¢

æ„Ÿè°¢æ‰€æœ‰ä¸º ArtiPub è´¡çŒ®çš„å¼€å‘è€…ï¼Œä»¥åŠæ‰€æœ‰ä½¿ç”¨å’Œæ”¯æŒæ­¤é¡¹ç›®çš„äººã€‚å¦‚æœè¿™ä¸ªåº“å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œçƒ¦è¯·èµ äºˆä¸€ä¸ªâ­ï¸ä½œä¸ºæ”¯æŒï¼Œæ‚¨çš„é¼“åŠ±æ˜¯æˆ‘ä»¬æŒç»­è¿›æ­¥çš„æœ€å¤§åŠ¨åŠ›ï¼Œè¡·å¿ƒæ„Ÿè°¢ï¼ğŸŒ¹
